
name: Build PDF and Deploy to GitHub Pages
concurrency: marp-to-pages

on:
  push:
    branches:
      - main
  
    paths:
      - slides/**
      - .github/workflows/deploy.yml

jobs:
  build:
    runs-on: ubuntu-latest

    permissions:
      contents: write

    steps:

      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Ensure build dir exists
        run: mkdir -p build

      - name: Copy images and fonts
        run: if [[ -d slides/ ]]; then cp -R slides/* build/; fi

      - name: Markdown to HTML
        uses: docker://ghcr.io/marp-team/marp-cli:v4.2.3
        env:
          MARP_USER: root:root
        with:
          args: slides/main.md -o build/index.html --html

      - name: Deploy production
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: ./build/

